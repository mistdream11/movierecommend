doctype html
html
  head
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    title 选择电影类型
    style.
      body {
        font-family: 'Open Sans', sans-serif;
        background: #f7f7f7;
        margin: 0;
        padding: 40px;
        color: #333;
      }
      .container {
        max-width: 960px;
        margin: 0 auto;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.08);
        padding: 30px 40px;
      }
      h1 {
        margin-top: 0;
        font-size: 32px;
        color: #222;
      }
      .intro {
        font-size: 16px;
        margin-bottom: 20px;
        color: #555;
      }
      .error {
        color: #c62828;
        background: #fdecea;
        border: 1px solid #f5c6cb;
        padding: 10px 15px;
        border-radius: 6px;
        margin-bottom: 20px;
      }
      .genre-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 10px;
        max-height: 360px;
        overflow-y: auto;
        padding: 10px;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        background: #fafafa;
      }
      .genre-item {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 6px 8px;
        border-radius: 4px;
        transition: background 0.2s ease;
      }
      .genre-item:hover {
        background: #e3f2fd;
      }
      .actions {
        margin-top: 25px;
        text-align: right;
      }
      button {
        padding: 10px 28px;
        font-size: 16px;
        background: #1976d2;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background 0.2s ease;
      }
      button:hover {
        background: #115293;
      }
  body
    .container
      h1 你好 #{username}，请选择喜欢的电影类型
      p.intro 至少选择一个类型，我们将基于这些偏好为你挑选电影进行打分。
      if message
        p.error #{message}
      form(action='/selectgenres', method='post', onsubmit='return validateGenreSelection();')
        input(type='hidden', name='userid', value=userid)
        input(type='hidden', name='username', value=username)
        .genre-grid
          if genres && genres.length
            each genre in genres
              label.genre-item
                input(type='checkbox', name='genres', value=genre)
                span #{genre}
          else
            p 暂无可选类型，请联系管理员。
        .actions
          button(type='submit') 确认并继续
    script.
      function validateGenreSelection() {
        var checked = document.querySelectorAll('input[name="genres"]:checked');
        if (!checked.length) {
          alert('请至少选择一个类型标签');
          return false;
        }
        return true;
      }
